The provided document is an Operation Control Language (OCL) script for an IBM System/3x or AS/400 environment, specifically for the RPG program `AR900`. OCL is used to define job control and file operations for RPG programs. Below, I’ll explain the process steps of the OCL script, list the external programs called, and identify the tables (files) used.

### Process Steps of the RPG .OCL Program

The OCL script sets up the environment, defines file access, and executes the RPG program `AR900` for customer master add/update operations in an Accounts Receivable (AR) system. Here’s a breakdown of the steps:

1. **Program and Environment Setup**:
   - `SCPROCP ,,,,,,,,?9?`: Likely specifies a procedure or program identifier, with `?9?` as a placeholder for a parameter (possibly a company code or environment variable).
   - `GSY2K`: Indicates Year 2000 compliance or a specific system configuration.
   - `LOCAL OFFSET-480,DATA-'?9?'`: Sets a local variable at offset 480 with the value of parameter `?9?` (e.g., company code).
   - `LOCAL OFFSET-410,DATA-'?WS?'`: Sets a local variable at offset 410 with the value of parameter `?WS?` (possibly workstation ID).
   - `LOCAL OFFSET-400,DATA-'?USER?'`: Sets a local variable at offset 400 with the value of parameter `?USER?` (user ID).

2. **Conditional Index Build**:
   - `IFF ACTIVE-AR300 IFF DATAF1-?9?CRDETX BLDINDEX ?9?CRDETX,2,8,+ ?9?ARDETL,,DUPKEY,,71,8,10,7`:
     - Checks if program `AR300` is active and if the file `?9?CRDETX` (credit detail transaction file) exists with data.
     - If conditions are met, builds an index for the file `?9?CRDETX`:
       - Key starts at position 2, length 8, ascending order (`+`).
       - References `?9?ARDETL` (AR detail file).
       - Allows duplicate keys (`DUPKEY`).
       - Additional key fields at position 71 (length 8), position 10 (length 7).
     - This ensures efficient access to credit transaction data.

3. **Load the RPG Program**:
   - `LOAD AR900`: Loads the RPG program `AR900` into memory for execution.

4. **File Definitions**:
   - Multiple `FILE NAME` statements define the files (tables) used by `AR900` and related programs, with `LABEL-?9?<filename>` indicating the file name prefixed with the parameter `?9?` (e.g., company code) and `DISP-SHR` specifying shared access:
     - `ARCUST`: Customer master file.
     - `ARCUSP`: Customer suspense file.
     - `ARCUPR`: Customer pricing file.
     - `CRDETX`: Credit detail transaction file.
     - `ARCONT`: AR control file.
     - `BICONT`: Billing control file.
     - `GSPROD`: General system product file.
     - `GSTABL`: General system table file.
     - `BISLTX`: Billing sales tax file.
     - `ARCLGR`: AR customer ledger file.
     - `ARCUST2`: Secondary customer master file (same label as `ARCUST`).
     - `ARCUSHS`: Customer ship-to history file.
     - `ARCUSPH`: Customer phone history file.
     - `ARCUPHS`: Customer pricing history file.
     - For program `AR9009`:
       - `SA5FIXD`, `SA5FIXM`: Fixed data files.
       - `SA5BCXD`, `SA5BCXM`: Billing customer extension files.
       - `SA5DBXD`, `SA5DBXM`: Debit extension files.
       - `SA5COXD`, `SA5COXM`: Credit order extension files.
     - For program `AR9006`:
       - `PFARCUPR`, `PTARCUPR`: Pricing files (same label as `ARCUPR`).
     - For program `AR915P`:
       - `ARCUFM`, `ARCUFMX`: Customer format files.
     - For program `BI907`:
       - `SHIPTO`: Ship-to address file.
       - `ARCUP3`: Customer pricing extension file.

5. **Program Execution**:
   - `RUN`: Executes the loaded `AR900` program, which processes customer master add/update operations using the defined files.

6. **Post-Execution**:
   - `ARFX39 ,,,,,,,,?9?`: Likely a cleanup or follow-up procedure, possibly closing files or logging, with `?9?` as a parameter.

### External Programs Called

The OCL script references several external programs that `AR900` may call or that are related to the file definitions:
- `AR9009`: Likely handles specific customer data processing (e.g., fixed or extension data).
- `AR9006`: Manages customer pricing operations.
- `AR915P`: Processes customer format data.
- `BI907`: Handles billing or ship-to address processing.
- `AR300`: Referenced in the conditional index build, possibly an AR-related program that must be active.

### Tables (Files) Used

The files (tables) defined in the OCL script are:
1. `ARCUST`: Customer master file.
2. `ARCUSP`: Customer suspense file.
3. `ARCUPR`: Customer pricing file.
4. `CRDETX`: Credit detail transaction file.
5. `ARCONT`: AR control file.
6. `BICONT`: Billing control file.
7. `GSPROD`: General system product file.
8. `GSTABL`: General system table file.
9. `BISLTX`: Billing sales tax file.
10. `ARCLGR`: AR customer ledger file.
11. `ARCUST2`: Secondary customer master file.
12. `ARCUSHS`: Customer ship-to history file.
13. `ARCUSPH`: Customer phone history file.
14. `ARCUPHS`: Customer pricing history file.
15. `SA5FIXD`: Fixed data file (for `AR9009`).
16. `SA5FIXM`: Fixed master file (for `AR9009`).
17. `SA5BCXD`: Billing customer extension detail (for `AR9009`).
18. `SA5BCXM`: Billing customer extension master (for `AR9009`).
19. `SA5DBXD`: Debit extension detail (for `AR9009`).
20. `SA5DBXM`: Debit extension master (for `AR9009`).
21. `SA5COXD`: Credit order extension detail (for `AR9009`).
22. `SA5COXM`: Credit order extension master (for `AR9009`).
23. `PFARCUPR`: Pricing file (for `AR9006`).
24. `PTARCUPR`: Pricing file (for `AR9006`).
25. `ARCUFM`: Customer format file (for `AR915P`).
26. `ARCUFMX`: Customer format extension file (for `AR915P`).
27. `SHIPTO`: Ship-to address file (for `BI907`).
28. `ARCUP3`: Customer pricing extension file (for `BI907`).
29. `ARDETL`: AR detail file (referenced in index build).

### Summary

The OCL script for `AR900` orchestrates a customer master add/update process in an AR system by:
- Setting up environment variables and parameters.
- Conditionally building an index for credit transaction data.
- Loading the `AR900` RPG program.
- Defining shared-access files for customer, pricing, billing, and control data.
- Executing the program to process customer updates.
- Potentially invoking a follow-up procedure (`ARFX39`).

**External Programs Called**: `AR9009`, `AR9006`, `AR915P`, `BI907`, `AR300` (conditional check).
**Tables Used**: 29 files, including `ARCUST`, `ARCUPR`, `CRDETX`, `ARCONT`, `SA5FIXD`, `SHIPTO`, and others listed above.

Let me know if you need further clarification or analysis of the RPG program logic (if source code is available)!